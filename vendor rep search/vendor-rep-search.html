<!doctype html>
<html lang="en">
<head>
	<title>SpRestLib API Demos</title>
	<meta charset="utf-8">
	<meta name="viewport"    content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="author"      content="https://github.com/gitbrent/">
	<meta name="website"     content="https://github.com/gitbrent/SpRestLib/">
	<meta name="keywords"    content="SpRestLib, JavaScript, js-sharepoint, SP2013 REST, SharePoint 2013, SharePoint 2016, SharePoint Online">
	<meta name="description" content="Content Editor Webpart: SpRestLib features and capabilities">
	<meta name="revised"     content="20190122">

	<!-- HOWTO / FAQ / SETUP -->
	<!--
		SETUP:
		1) Add this file to your SharePoint `SiteAssets` Library
		2) Create a new Page named "sprestlib-demo.aspx"
		3) Add a Content Editor Web Part to the page and set its source to "../SiteAssets/sprestlib-demo.html" (or wherever)
		4) The "sprestlib-demo.aspx" page is ready to be used!
		HELP:
		*) Check the img folder for screencaps of the SharePoint setup!
	-->

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.2.1/yeti/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-okaidia.min.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

	<style>
		.ms-webpartPage-root { border-spacing: 0px !important; /* FIX-O365 */ }

		/* -- brentstrap.css ---------- */
		.bde-arrow-cont {
			cursor: pointer;
			-webkit-user-select: none;
		       -moz-user-select: none;
		        -ms-user-select: none;
		            user-select: none;
		}
		.bde-arrow-cont span.text-muted {
			font-size: 50% !important;
			color: #b9c9d9 !important;
			text-transform: none !important;
			margin-left: 4px;
		}
		.arrow {
			display: inline-block;
			height: 12px; width: 12px;
			border-top: 3px solid #0085C3; border-right: 3px solid #0085C3;
			margin-right: 10px;
			cursor: pointer;
			transition: all .25s ease;
			transform: rotate(45deg);
		}
		.arrow.active {
			transform: rotate(135deg);
			margin-bottom: 3px;
		}
		.bde-callout-info {
			padding: 1.1rem;
			border: 1px solid #eee;
			border-left-width: .25rem;
			border-radius: .25rem;
			border-left-color: #5bc0de;
		}

		.nowctr { white-space: nowrap !important; text-align: center !important; }
		/* -- brentstrap.css ---------- */
		.text-muted { font-weight:normal; }
		.code { white-space: pre !important; }
		#sandboxCode:focus {
			/* Chrome draws a super-annoying outline around *each line* in the <code> tag, so NOPE! */
		    outline: none; /*-webkit-focus-ring-color auto 5px;*/
		}

		/* ------------------------------------------------------------------------- */
		/* 2017-10 Brent SVG Images */
		div.iconSvg td.iconSvg {
			display: inline-block;
			background-size: contain;
			max-width: 256px;
			max-height: 256px;
		}
		div.iconSvg.size16 { width:16px; height:16px; }
		div.iconSvg.size20 { width:20px; height:20px; }
		div.iconSvg.size24 { width:24px; height:24px; }
		div.iconSvg.size32 { width:32px; height:32px; }
		div.iconSvg.size48 { width:48px; height:48px; }
		div.iconSvg.circle.question, div.iconSvg.question {
			background-image:
				url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDUwIDUwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MCA1MDsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxjaXJjbGUgc3R5bGU9ImZpbGw6IzQ4QTBEQzsiIGN4PSIyNSIgY3k9IjI1IiByPSIyNSIvPgo8bGluZSBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojRkZGRkZGO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEwOyIgeDE9IjI1IiB5MT0iMzciIHgyPSIyNSIgeTI9IjM5Ii8+CjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNGRkZGRkY7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MTA7IiBkPSJNMTgsMTYgIGMwLTMuODk5LDMuMTg4LTcuMDU0LDcuMS02Ljk5OWMzLjcxNywwLjA1Miw2Ljg0OCwzLjE4Miw2LjksNi45YzAuMDM1LDIuNTExLTEuMjUyLDQuNzIzLTMuMjEsNS45ODYgIEMyNi4zNTUsMjMuNDU3LDI1LDI2LjI2MSwyNSwyOS4xNThWMzIiLz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPC9zdmc+Cg==);
		}
		div.iconSvg.yes, div.iconSvg.check {
			background-image:
				url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaWQ9IkxheWVyXzEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTI7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB4bWw6c3BhY2U9InByZXNlcnZlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7ZmlsbDojMkJCNjczO30uc3Qxe2ZpbGw6bm9uZTtzdHJva2U6I0ZGRkZGRjtzdHJva2Utd2lkdGg6MzA7c3Ryb2tlLW1pdGVybGltaXQ6MTA7fTwvc3R5bGU+PHBhdGggY2xhc3M9InN0MCIgZD0iTTQ4OSwyNTUuOWMwLTAuMiwwLTAuNSwwLTAuN2MwLTEuNiwwLTMuMi0wLjEtNC43YzAtMC45LTAuMS0xLjgtMC4xLTIuOGMwLTAuOS0wLjEtMS44LTAuMS0yLjcgIGMtMC4xLTEuMS0wLjEtMi4yLTAuMi0zLjNjMC0wLjctMC4xLTEuNC0wLjEtMi4xYy0wLjEtMS4yLTAuMi0yLjQtMC4zLTMuNmMwLTAuNS0wLjEtMS4xLTAuMS0xLjZjLTAuMS0xLjMtMC4zLTIuNi0wLjQtNCAgYzAtMC4zLTAuMS0wLjctMC4xLTFDNDc0LjMsMTEzLjIsMzc1LjcsMjIuOSwyNTYsMjIuOVMzNy43LDExMy4yLDI0LjUsMjI5LjVjMCwwLjMtMC4xLDAuNy0wLjEsMWMtMC4xLDEuMy0wLjMsMi42LTAuNCw0ICBjLTAuMSwwLjUtMC4xLDEuMS0wLjEsMS42Yy0wLjEsMS4yLTAuMiwyLjQtMC4zLDMuNmMwLDAuNy0wLjEsMS40LTAuMSwyLjFjLTAuMSwxLjEtMC4xLDIuMi0wLjIsMy4zYzAsMC45LTAuMSwxLjgtMC4xLDIuNyAgYzAsMC45LTAuMSwxLjgtMC4xLDIuOGMwLDEuNi0wLjEsMy4yLTAuMSw0LjdjMCwwLjIsMCwwLjUsMCwwLjdjMCwwLDAsMCwwLDAuMXMwLDAsMCwwLjFjMCwwLjIsMCwwLjUsMCwwLjdjMCwxLjYsMCwzLjIsMC4xLDQuNyAgYzAsMC45LDAuMSwxLjgsMC4xLDIuOGMwLDAuOSwwLjEsMS44LDAuMSwyLjdjMC4xLDEuMSwwLjEsMi4yLDAuMiwzLjNjMCwwLjcsMC4xLDEuNCwwLjEsMi4xYzAuMSwxLjIsMC4yLDIuNCwwLjMsMy42ICBjMCwwLjUsMC4xLDEuMSwwLjEsMS42YzAuMSwxLjMsMC4zLDIuNiwwLjQsNGMwLDAuMywwLjEsMC43LDAuMSwxQzM3LjcsMzk4LjgsMTM2LjMsNDg5LjEsMjU2LDQ4OS4xczIxOC4zLTkwLjMsMjMxLjUtMjA2LjUgIGMwLTAuMywwLjEtMC43LDAuMS0xYzAuMS0xLjMsMC4zLTIuNiwwLjQtNGMwLjEtMC41LDAuMS0xLjEsMC4xLTEuNmMwLjEtMS4yLDAuMi0yLjQsMC4zLTMuNmMwLTAuNywwLjEtMS40LDAuMS0yLjEgIGMwLjEtMS4xLDAuMS0yLjIsMC4yLTMuM2MwLTAuOSwwLjEtMS44LDAuMS0yLjdjMC0wLjksMC4xLTEuOCwwLjEtMi44YzAtMS42LDAuMS0zLjIsMC4xLTQuN2MwLTAuMiwwLTAuNSwwLTAuNyAgQzQ4OSwyNTYsNDg5LDI1Niw0ODksMjU1LjlDNDg5LDI1Niw0ODksMjU2LDQ4OSwyNTUuOXoiIGlkPSJYTUxJRF8zXyIvPjxnIGlkPSJYTUxJRF8xXyI+PGxpbmUgY2xhc3M9InN0MSIgaWQ9IlhNTElEXzJfIiB4MT0iMjEzLjYiIHgyPSIzNjkuNyIgeTE9IjM0NC4yIiB5Mj0iMTg4LjIiLz48bGluZSBjbGFzcz0ic3QxIiBpZD0iWE1MSURfNF8iIHgxPSIyMzMuOCIgeDI9IjE1NC43IiB5MT0iMzQ1LjIiIHkyPSIyNjYuMSIvPjwvZz48L3N2Zz4=);
		}
		div.iconSvg.no,  div.iconSvg.fail {
			background-image:
				url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDUwIDUwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MCA1MDsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxjaXJjbGUgc3R5bGU9ImZpbGw6I0Q3NUE0QTsiIGN4PSIyNSIgY3k9IjI1IiByPSIyNSIvPgo8cG9seWxpbmUgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6I0ZGRkZGRjtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDsiIHBvaW50cz0iMTYsMzQgMjUsMjUgMzQsMTYgICAiLz4KPHBvbHlsaW5lIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNGRkZGRkY7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MTA7IiBwb2ludHM9IjE2LDE2IDI1LDI1IDM0LDM0ICAgIi8+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=);
		}
		div.iconSvg.xmark {
			background-image:
				url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDQ0OS45OTggNDQ5Ljk5OCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDQ5Ljk5OCA0NDkuOTk4OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4Ij48Zz48Zz48cG9seWdvbiBwb2ludHM9IjQ0OS45NzQsMzQuODU1IDQxNS4xOTEsMCAyMjUuMDA3LDE5MC4xODQgMzQuODM5LDAgMC4wMjQsMzQuODM5IDE5MC4xOTIsMjI0Ljk5OSAgICAgMC4wMjQsNDE1LjE1OSAzNC44MzksNDQ5Ljk5OCAyMjUuMDA3LDI1OS43OTcgNDE1LjE5MSw0NDkuOTk4IDQ0OS45NzQsNDE1LjE0MyAyNTkuODMsMjI0Ljk5OSAgICIgZmlsbD0iI0Q4MDAyNyIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+);
		}
		div.iconSvg.circle.info {
			background-image:
				url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4IiB2aWV3Qm94PSIwIDAgMzQ3LjYxMiAzNDcuNjEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzNDcuNjEyIDM0Ny42MTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj48Zz48Zz48cGF0aCBmaWxsPSIjMDA4OENDIiBkPSJNMTczLjgwNywwQzc3Ljk3LDAsMCw3Ny45NywwLDE3My44MDZDMCwyNjkuNjQsNzcuOTcsMzQ3LjYxMiwxNzMuODA3LDM0Ny42MTJjOTUuODMzLDAsMTczLjgwNi03Ny45NzMsMTczLjgwNi0xNzMuODA3IEMzNDcuNjEyLDc3Ljk3LDI2OS42NCwwLDE3My44MDcsMHogTTE5Ni40ODksMjY5LjQ0N2MwLDkuOTMzLTguMDcsMTcuOTk3LTE3Ljk5LDE3Ljk5N2MtOS45MTQsMC0xNy45NjktOC4wNjQtMTcuOTY5LTE3Ljk5NyBWMTM3LjM0MmMwLTkuODk4LDguMDU2LTE3Ljk2NiwxNy45NjktMTcuOTY2YzkuOTIsMCwxNy45OSw4LjA2OCwxNy45OSwxNy45NjZWMjY5LjQ0N3ogTTE3OS4yMzQsMTAxLjE1NyBjLTExLjI5NCwwLTIwLjQ5NC05LjE5My0yMC40OTQtMjAuNDk1czkuMTkzLTIwLjQ5NSwyMC40OTQtMjAuNDk1YzExLjMwNSwwLDIwLjQ5OCw5LjE5MywyMC40OTgsMjAuNDk1IFMxOTAuNTM5LDEwMS4xNTcsMTc5LjIzNCwxMDEuMTU3eiIgLz48L2c+PC9nPjwvc3ZnPg==);
		}
		div.iconSvg.lock {
			background-image:
				url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDU4IDU4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OCA1ODsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxwYXRoIHN0eWxlPSJmaWxsOiNDN0NBQzc7c3Ryb2tlOiNDN0NBQzc7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7IiBkPSJNNDIsMzJIMTVWMTMuNjAxQzE1LDYuNjUyLDIxLjA1NiwxLDI4LjUsMSAgUzQyLDYuNjUyLDQyLDEzLjYwMVYzMnogTTE5LDI4aDE5VjEzLjYwMUMzOCw4Ljg1OCwzMy43MzgsNSwyOC41LDVTMTksOC44NTgsMTksMTMuNjAxVjI4eiIvPgo8cmVjdCB4PSI4IiB5PSIyNiIgc3R5bGU9ImZpbGw6IzczODNCRjsiIHdpZHRoPSI0MiIgaGVpZ2h0PSIzMiIvPgo8cmVjdCB4PSIyOSIgeT0iMjYiIHN0eWxlPSJmaWxsOiM2ODc5QUY7IiB3aWR0aD0iMjEiIGhlaWdodD0iMzIiLz4KPHBvbHlnb24gc3R5bGU9ImZpbGw6I0VCQkExNjsiIHBvaW50cz0iNDIuNTg2LDU3IDQ5LDUwLjU4NiA0OSw0NyA0My40MTQsNDcgMzMuNDE0LDU3ICIvPgo8cG9seWdvbiBzdHlsZT0iZmlsbDojNEY1OTcwOyIgcG9pbnRzPSI5LDQ3IDksNTQuNTg2IDE2LjU4Niw0NyAiLz4KPHBvbHlnb24gc3R5bGU9ImZpbGw6IzQyNEE2MDsiIHBvaW50cz0iMzAuNTg2LDU3IDQwLjU4Niw0NyAzMS40MTQsNDcgMjEuNDE0LDU3ICIvPgo8cGF0aCBzdHlsZT0iZmlsbDojRUFDQzE4OyIgZD0iTTI4LjU4Niw0N2gtOS4xNzJsLTkuNzA3LDkuNzA3QzkuNTEyLDU2LjkwMiw5LjI1Niw1Nyw5LDU3aDkuNTg2TDI4LjU4Niw0N3oiLz4KPHBvbHlnb24gc3R5bGU9ImZpbGw6IzQyNEE2MDsiIHBvaW50cz0iNDksNTcgNDksNTMuNDE0IDQ1LjQxNCw1NyAiLz4KPHBvbHlnb24gc3R5bGU9ImZpbGw6IzRGNTk3MDsiIHBvaW50cz0iMjksNDkuNDE0IDIxLjQxNCw1NyAyOSw1NyAiLz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPC9zdmc+Cg==);
		}
		div.iconSvg.reload, div.iconSvg.refresh {
			background-image:
				url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIuMDAyIDUxMi4wMDIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMi4wMDIgNTEyLjAwMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMDg4Y2M7IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCAyNTYgMjU2KSIgZD0iTTQzNi44NjYsNDM2Ljg3MWM0OC4zMTItNDguMzExLDc0LjkyMS0xMTIuNTQ2LDc0LjkyMS0xODAuODcxIGMwLTE0MS4wMzktMTE0Ljc0NC0yNTUuNzg1LTI1NS43ODMtMjU1Ljc4NnY0OS41MDdjMTEzLjc0MSwwLjAwMiwyMDYuMjc2LDkyLjUzOSwyMDYuMjc2LDIwNi4yNzljMCw1NS4xMDEtMjEuNDU4LDEwNi45MDItNjAuNDIsMTQ1Ljg2NGwtNy41NzEsNy41NzFsLTY3LjU1Mi02Ny41NTJsMC4wMjEsMTcwLjA3NmwxNzAuMDk2LDAuMDQxbC02Ny41NTktNjcuNTU5TDQzNi44NjYsNDM2Ljg3MXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDA4OGNjOyIgdHJhbnNmb3JtPSJyb3RhdGUoOTAgMjU2IDI1NikiIGQ9Ik00OS43MjQsMjU2LjAwMWMwLTU1LjEwMSwyMS40NTgtMTA2LjkwMiw2MC40Mi0xNDUuODY0bDcuNTcxLTcuNTcxbDY3LjU1Miw2Ny41NTJMMTg1LjI0NSwwLjA0MUwxNS4xNDgsMGw2Ny41NTksNjcuNTU5bC03LjU3MSw3LjU3QzI2LjgyNCwxMjMuNDM5LDAuMjE1LDE4Ny42NzUsMC4yMTUsMjU1Ljk5OWMwLDE0MS4wMzksMTE0Ljc0NCwyNTUuNzg1LDI1NS43ODMsMjU1Ljc4NnYtNDkuNTA3QzE0Mi4yNTgsNDYyLjI3OCw0OS43MjQsMzY5Ljc0Miw0OS43MjQsMjU2LjAwMXoiLz48L3N2Zz4=);
		}

		/* Flex modernTabs (Fall-2017) */
		.flexTabs {
			width: 100%;
			margin: 20px 0 10px 0;
			border: 1px solid #d5d5d5;
			box-shadow: 0px 4px 10px -5px rgba(0,0,0,0.5);
			border-radius: 5px;
		}
		.flexTabs > ul {
			display: flex;
			background: #F6F6F6;
		    list-style-type: none;
		    margin: 0 !important; -webkit-margin-before: 0;  -moz-margin-before: 0;  -ms-margin-before: 0;
		    padding: 0 !important;
		    border-bottom: 1px solid #d5d5d5;
		    border-radius: 5px 5px 0 0;
		}
		.flexTabs > ul > li {
			flex: 1 0 auto;
			box-sizing: border-box;
		    cursor: pointer;
		    text-shadow: 2px 2px #efefef;
		    text-align: center;
		    display: inline-block;
			list-style-type: none;
		    padding: 15px;
		    font-size: 14px;
		    color: #a7a7a7;
		    text-transform: uppercase;
		    border-bottom: 3px solid #F6F6F6;
		    -webkit-user-select: none;
		       -moz-user-select: none;
		        -ms-user-select: none;
		            user-select: none;
		}
		.flexTabs > ul > li.active {
		    font-weight: bold;
		    text-shadow: none;
		    color: #0088CC;
		    border-bottom: 3px solid #0088cc;
		}
		.flexTabs > div {
		    display: none;
		    margin: 0;
		    padding: 1.5rem 2rem;
		    background: white;
		    border-radius: 0 0 5px 5px;
		}
		.flexTabs > div.active { display: block; }
		.flexTabs > div > .toolBar { width: 100%; min-height: 44px; display: table; margin-top: -20px; }
		.flexTabs > div > .toolBar > div:first-child { display:table-cell; width:75%; text-align: left; padding:10px 0; vertical-align:middle; color:#bcd; }
		.flexTabs > div > .toolBar > div:last-child  { display:table-cell; width:25%; text-align:right; padding:10px 0; vertical-align:middle; white-space:nowrap; }
		.flexTabs > div > .toolBar button { border-radius: 2px; text-transform: none; }
		.flexTabs > div > .toolBar img { vertical-align:middle; margin:-3px 3px 0 0; }

		/* ------------------------------------------------------------------------- */
		.tabModern {
			width: 100%;
			border-collapse: collapse;
			margin: 0px;
		}
		.tabModern > tbody > tr > th, .tabModern > tbody > tr > td { border: 1px #f1f1f1 solid; }
		.tabModern th.icon {
			width: 1%;
			padding: 0 4px;
		}
		.tabModern td.icon {
			width: 1%;
			padding: 0 4px 0 0;
			background: #f8fbff;
		}
		.tabModern > thead > tr > th {
			background: #E5F2FA;
			border-left: 1px white solid;
			border-bottom: 1px white solid;
			border-top: 1px #e7e7f3 solid;
			text-align: left;
			padding: 8px;
			font-size: 11px;
			font-weight: normal;
			color: #0090C0;
			text-transform: uppercase;
			white-space: nowrap;
			vertical-align: middle;
		}
		.tabModern > thead > tr > th.title {
		    background: #0088cc;
		    text-align: center;
		    padding: 10px;
		    color: white;
		    font-size: 14px;
		    font-weight: bold;
		}
		.tabModern > thead > tr > th:first-child {
			border-left: 1px #e7e7f3 solid;
		}
		.tabModern > thead > tr > th:last-child {
			border-right: 1px #e7e7f3 solid;
		}
		.tabModern > tbody > tr > th {
			text-align: left;
			font-weight: normal;
			padding: 6px 10px;
			background: #f2f9fc;
			color: #0088cc;
			box-sizing: border-box;
			border-bottom: 1px solid white !important;
		}
		.tabModern > tbody > tr > td {
			text-align: left;
			padding: 6px 10px;
			background: white;
			box-sizing: border-box;
		}
		.tabModern > tbody > tr > td > a:link {
			text-decoration: underline;
		}
		.tabModern > tfoot > tr > td { padding: 15px; text-align: center; }
		.tabModern td.gray { background: #f7f7f7; }
		.tabModern td.blue { background: #E5F2FA; }
		.tabModern th.tabModernSection, .tabModern td.tabModernSection {
			background: #E5F2FA !important;
			text-align: center !important;
			padding: 8px !important;
			color: #0F5199;
		}
		.tabModern.shadow { box-shadow:2px 2px 6px 2px #aaa; }

		/* tablesorter.css */
		.tablesorter thead th {
			border-left: 1px white solid !important;
			border-right: 1px white solid !important;
			border-top: 1px #e7e7f3 solid !important;
			border-bottom: 1px #e7e7f3 solid !important;
		}
		.tablesorter thead th:first-child { border-left:  1px #e7e7f3 solid !important; }
		.tablesorter thead th:last-child  { border-right: 1px #e7e7f3 solid !important; }
		.tablesorter thead .tablesorter-header {
			background-repeat: no-repeat;
			background-position: right 8px center;
			cursor: pointer;
		}
		.tablesorter thead .tablesorter-headerAsc      { background-color:#a9d4ef !important; color:#ffffff !important; background-image:url('data:image/gif;base64,R0lGODlhBwAEAIAAAP///////yH5BAEAAAEALAAAAAAHAAQAAAIHjGEJq8sOCwA7') !important; }
		.tablesorter thead .tablesorter-headerDesc     { background-color:#a9d4ef !important; color:#ffffff !important; background-image:url('data:image/gif;base64,R0lGODlhBwAEAIAAAP///////yH5BAEAAAEALAAAAAAHAAQAAAIIhA+BGWoNWSgAOw') !important; }
		.tablesorter thead .tablesorter-headerUnSorted { background-color:#E5F2FA !important; color:#0090C0 !important; background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAKElEQVR42mNgQAYTDvxnwApAEjCMUwJFATYJrCbgtYtoo4lzLQ5/AgB5EEnhsdUsjwAAAABJRU5ErkJggg==') !important; }
		.tablesorter > tbody > tr > td { border: 1px #F1F1F1 solid !important; color:#696969 !important; }
		/* tablesorter - Make room for sort icons */
		.tablesorter > thead > tr > th { padding: 6px 20px 6px 8px !important; }
		.tablesorter > thead > tr > th.sorter-false { padding: 6px 8px !important; cursor: default; }
		.tabModern > thead > tr > th.sorter-false { background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7') !important; }
		/* icon.checkbox cells in tbody */
		.tablesorter > tbody > tr > td.icon {
			width: 1%;
			background: #f8fbff;
			text-align: center;
			white-space: nowrap;
			border-top:1px solid #fff !important;
			border-bottom:1px solid #fff !important;
			padding: 0 4px;
			vertical-align: middle;
		}
		.tablesorter > tbody > tr > td.icon:last-child { border-bottom: 1px solid #F1F1F1; }
		td img {
			max-width: 256px;
			max-height: 128px;
		}
		td p {
			overflow-wrap: break-word;
			max-width: 250px;
			font-size: .76rem
		}
	</style>

	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/gh/gitbrent/SpRestLib/dist/sprestlib.bundle.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/sorensen/ascii-table@0.0.9/ascii-table.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.29.0/js/jquery.tablesorter.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js"></script>

	<script>
	// Author: Johnathan Zamora
	// Date: 11/15/2019
	// Thank you @gitbrent on Github.com -- Don't reinvent the wheel!

		let SPINNER = '<tr><td><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></td></tr>';
		let LAYOUTS_URL = ( typeof _spPageContextInfo !== 'undefined' && _spPageContextInfo.layoutsUrl ? _spPageContextInfo.layoutsUrl : '_layouts/15' );
		// used in some pre calculations
		var mrlistReferenceMaster = [];
		var vlistReferenceMaster = [];
		var usersReferenceMaster = [];
		let VENDOR_LIMIT = 800;
		let MANREP_LIMIT = 500;

		function doPageLoad() {
			// STEP 1: HTML Setup
			document.title = "Vendor Rep Search";
			// Hard-set where we want to look for lists at
			sprLib.options ( {baseUrl: '/sites/Sales'} );

			// Pre-Load Manufacturer Rep && Vendor Reference && user ids
			{
				sprLib.list('Manufacturer Reps')
				.items({
					listCols: ['Id', 'ManufacturerRep'],
					queryLimit: MANREP_LIMIT,
				})
				.then(objList => {
					mrlistReferenceMaster = objList.slice();
					console.log("mrlistReferenceMaster is ready");
				});

				sprLib.list('Vendor List')
				.items({
					listCols: ['Id', 'Title', 'VendorNum'],
					queryLimit: VENDOR_LIMIT,
				})
				.then(objList => {
					vlistReferenceMaster = objList.slice();
					console.log("vlistReferenceMaster is ready");
				});

				sprLib.rest({
					url: "/sites/sales/_api/web/siteusers",
				    queryCols: ['Groups', 'Id', 'Title']
				}).then( obj => usersReferenceMaster = obj.slice() )

			}

			$('#AppNavTab').click().hide()
		}

		// ==================================================================================================================
		$(document).ready(function(){
			// If you're me Do Special Stuff!
			if ( sprLib.user().info().then( objList => objList.Email == "johnz@centralazsupply.com")) {
				// Do special stuff

				doPageLoad();
			}
			else if ( typeof sprLib === 'undefined' ) {
				alert("Oops!\n\n`sprLib` is undefined - maybe a bad link to the 'sprestlib.js' file or something...?\n");
				return;
			}
			else {
				doPageLoad();
			}

		});

		// ==================================================================================================================
		$(document).keypress(function(e){
			// BIND ENTER KEY TO THE SEARCH BUTTON
    			if (e.which == 13){
        			$("#searchInputBtn").click();
    			}
			});


	let ListMaster = {
		vlist: {
			listCols :  {
				aa: { dataName: 'ManufacturerRep0Id' },
				a: 	{ dataName: 'Id'},
				// b: 	{ dataName: 'Logo'},
				c: 	{ dataName: 'Title' },
				d: 	{ dataName: 'VendorNum' },
				e: 	{ dataName: 'Placing_x0020_POs' },
				f: 	{ dataName: 'Phone' },
				g: 	{ dataName: 'Fax' },
				h: 	{ dataFunc: findManufactureRep },
				i: 	{ dataName: 'Website' },
				j: 	{ dataName: 'Parts_x0020_Sold' },
				k: 	{ dataName: 'Keywords' },
				l: 	{ dataFunc:  objItem => ListMaster.vlist.relativeItem+objItem.ID }
			},
			queryFilter: '',
			queryOrderBy: 'Title',
			queryLimit: VENDOR_LIMIT,
			// Keep track of which columns in vlist we want to search when we search
			myFieldsToSearch: ['Title', 'VendorNum', 'Keywords'],
			// Keep track of CSS for viewports
			myFieldsCss: [
				// {id:'vlistLogo', 	class:'view-small iconSvg'},
				{id:'vlistVendor', 	class:'view-tiny'},
				{id:'vlistVenNum', 	class:'view-medium'},
				{id:'vlistPO', 		class:''},
				{id:'vlistPhone', 	class:'view-tiny'},
				{id:'vlistFax', 	class:''},
				{id:'vlistManRep', 	class:'view-tiny'},
				{id:'vlistWeb', 	class:''},
				{id:'vlistParts', 	class:'view-medium'},
				{id:'vlistKeys', 	class:'view-medium'},
				{id:'vlistEdit', 	class:'view-show-all'},
			],
			myName: 'Vendor List',
			relativeList: "/sites/Sales/Lists/Vendor%20List/Default%20View.aspx",
			relativeItem: "/sites/Sales/Lists/Vendor%20List/DispForm.aspx?ID="  
		},
		vclist: {
			listCols :  {
				aa:{ dataName: 'Vendor_x0020_Name_x0020_NEWId' },
				a: { dataName: 'Id' },
				b: { dataName: 'Title'},
				c: { dataName: 'Last_x0020_Name' },
				d: { dataName: 'Job_x0020_Title' },
				e: { dataName: 'Email_x0020_Address' },
				f: { dataName: 'Business_x0020_Phone' },
				g: { dataName: 'Mobile_x0020_Number' },
				h: { dataName: 'Company' },
				i: { dataFunc: findVendor },
				j: { dataName: 'Keywords' },
				k: { dataFunc:  objItem => ListMaster.vclist.relativeItem+objItem.ID }
			},
			queryFilter: '',
			queryOrderBy: 'Last_x0020_Name',
			queryLimit: MANREP_LIMIT,
			// Keep track of which fields in vlist we want to search when we search
			myFieldsToSearch: ['Title', 'Last_x0020_Name', 'Company', 'Keywords'],
			myFieldsCss: [
				{ id: 'vclistFirst', class: 'view-tiny' },
				{ id: 'vclistLast', class: 'view-tiny' },
				{ id: 'vclistTitle', class: '' },
				{ id: 'vclistEmail', class: 'view-small' },
				{ id: 'vclistPhone', class: 'view-medium' },
				{ id: 'vclistCell', class: '' },
				{ id: 'vclistCompany', class: 'view-tiny' },
				{ id: 'vclistVendor', class: 'view-medium' },
				{ id: 'vclistKeys', class: '' },
				{ id: 'vclistEdit', class: 'view-show-all' },
			],
			myName: 'Vendor Contact List',
			relativeList: '/sites/Sales/Lists/Vendor%20Contact%20List/Default%20View.aspx',
			relativeItem: '/sites/Sales/Lists/Vendor%20Contact%20List/DispForm.aspx?ID='
		},
		mrlist: {
			listCols :  {
				aa: { dataName: 'Vendor_x0020_Name0Id' },
				a: 	{ dataName: 'Id'},
				// b: 	{ dataName: 'Logo'},
				c: 	{ dataName: 'ManufacturerRep' },
				d: 	{ dataName: 'Manufacturer_x0020_Rep_x0020__x0' },
				e: 	{ dataName: 'Email' },
				f: 	{ dataFunc: findManyVendors },
				k: 	{ dataName: 'Keywords' },
				l: 	{ dataFunc: objItem => ListMaster.mrlist.relativeItem+objItem.ID }
			},
			queryFilter: '',
			queryOrderBy: 'ManufacturerRep',
			queryLimit: MANREP_LIMIT,
			// Keep track of which columns in vlist we want to search when we search
			myFieldsToSearch: ['ManufacturerRep', 'Keywords'],
			// Keep track of CSS for viewports
			myFieldsCss: [
				// {id:'mrlistLogo', 	class:'view-small iconSvg'},
				{id:'mrlistManRep',	class:'view-tiny'},
				{id:'mrlistRepNum', class:'view-tiny'},
				{id:'mrlistEmail', 	class:'view-medium'},
				{id:'mrlistVendor', class:'view-small'},
				{id:'mrlistKeys', 	class:'view-medium'},
				{id:'mrlistEdit', 	class:'view-show-all'},
			],
			myName: 'Manufacturer Reps',
			relativeList: "/sites/Sales/Lists/Manufacturer%20Reps/Default.aspx",
			relativeItem: "/sites/Sales/Lists/Manufacturer%20Reps/DispForm.aspx?ID="
		},
		mrclist: {
			listCols :  {
				aaa:{dataName: 'ManufacturerRepId' },
				aa:{ dataName: 'Vendor_x0020_Name0Id' },
				a: { dataName: 'Id' },
				b: { dataName: 'Title'},
				c: { dataName: 'Last_x0020_Name' },
				d: { dataName: 'Job_x0020_Title' },
				e: { dataName: 'Email_x0020_Address' },
				f: { dataName: 'Business_x0020_Phone' },
				g: { dataName: 'Mobile_x0020_Number' },
				h: { dataFunc: findManufactureRep },
				i: { dataFunc: findManyVendors },
				k: { dataFunc:  objItem => ListMaster.mrclist.relativeItem+objItem.ID }
			},
			queryFilter: '',
			queryOrderBy: 'Last_x0020_Name',
			queryLimit: MANREP_LIMIT,
			// Keep track of which fields in vlist we want to search when we search
			myFieldsToSearch: ['Title', 'Last_x0020_Name'],
			myFieldsCss: [
				{ id: 'vclistFirst', class: 'view-tiny' },
				{ id: 'vclistLast', class: 'view-tiny' },
				{ id: 'vclistTitle', class: '' },
				{ id: 'vclistEmail', class: 'view-small' },
				{ id: 'vclistPhone', class: 'view-medium' },
				{ id: 'vclistCell', class: '' },
				{ id: 'vclistManRep', class: 'view-tiny' },
				{ id: 'vclistVendor', class: 'view-medium' },
				{ id: 'vclistEdit', class: 'view-show-all' },
			],
			myName: 'Manufacturer Rep Contact List',
			relativeList: '/sites/Sales/Lists/Manufacturer%20Rep%20Contact%20List/Default%20View.aspx',
			relativeItem: '/sites/Sales/Lists/Manufacturer%20Rep%20Contact%20List/DispForm.aspx?ID='
		},
		vdlist: {
			listCols :  {
				aaa:{dataName: 'EditorId' },
				aa:{ dataName: 'Vendor_x0020_Name0Id' },
				a: { dataName: 'Id' },
				b: { dataName: 'FileLeafRef'},
				c: { dataName: 'Document_x0020_Type' },
				d: { dataFunc: findManyVendors },
				e: { dataFunc: findEditor },
				f: { dataName: 'Modified' },
				i: { dataName: 'Keywords' },
				k: { dataFunc:  objItem => ListMaster.vdlist.relativeItem+objItem.FileLeafRef }
			},
			queryFilter: '',
			queryOrderBy: 'Document_x0020_Name',
			queryLimit: MANREP_LIMIT,
			// Keep track of which fields in vlist we want to search when we search
			myFieldsToSearch: ['Title'],
			myFieldsCss: [
				{ id: 'vdlistName', class: 'view-tiny' },
				{ id: 'vdlistType', class: 'view-medium' },
				{ id: 'vdlistVendor', class: 'view-small' },
				{ id: 'vdlistModified', class: 'view-medium' },
				{ id: 'vdlistModBy', class: 'view-tiny' },
				{ id: 'vdlistKeys', class: '' },
				{ id: 'vdlistEdit', class: 'view-show-all' },
			],
			myName: 'Vendor Documents',
			relativeList: '/sites/Sales/Vendor%20Documents/Forms/Default View.aspx',
			relativeItem: '/sites/Sales/Vendor%20Documents/'
		},
		vdetails: {
			listCols :  {
				aa:{ dataName: 'Vendor_x0020_NameId' },
				a: { dataName: 'Id' },
				b: { dataFunc: findVendor },
				c: { dataName: 'Suggested_x0020_Sales_x0020_Mult'},
				d: { dataName: 'Cost_x0020_Info' },
				e: { dataName: 'Freight_x0020_Info' },
				f: { dataName: 'Return_x0020_Information' },
				g: { dataName: 'Comments' },
				h: { dataName: 'Keywords' },
				i: { dataFunc:  objItem => ListMaster.vdetails.relativeItem+objItem.ID }
			},
			queryFilter: '',
			queryOrderBy: 'Vendor_x0020_NameId',
			queryLimit: MANREP_LIMIT,
			// Keep track of which fields in vlist we want to search when we search
			myFieldsToSearch: ['Keywords'],
			myFieldsCss: [
				{ id: 'vdetailsVendor', class: 'view-tiny' },
				{ id: 'vdetailsMulti', class: 'view-tiny' },
				{ id: 'vdetailsCost', class: 'view-medium' },
				{ id: 'vdetailsFreight', class: 'view-small' },
				{ id: 'vdetailsReturn', class: 'view-medium' },
				{ id: 'vdetailsComments', class: 'view-medium' },
				{ id: 'vdetailsKeys', class: '' },
				{ id: 'vdetailsEdit', class: 'view-show-all' },
			],
			myName: 'Vendor Details',
			relativeList: '/sites/Sales/Lists/Vendor%20Details/Default%20View.aspx',
			relativeItem: '/sites/Sales/Lists/Vendor%20Details/DispForm.aspx?ID='
		},
		products: {
			listCols :  {
				aa:{ dataName: 'Vendor_x0020_NameId' },
				a: { dataName: 'Id' },
				b: { dataFunc: findVendor },
				c: { dataName: 'Product_x0020_Line'},
				d: { dataName: 'Description' },
				e: { dataName: 'Whse' },
				f: { dataName: 'Buyer' },
				g: { dataName: 'Buyer_x0020_Initials' },
				h: { dataName: 'Keywords' },
				i: { dataFunc:  objItem => ListMaster.products.relativeItem+objItem.ID }
			},
			queryFilter: '',
			queryOrderBy: 'Product_x0020_Line',
			queryLimit: MANREP_LIMIT,
			// Keep track of which fields in vlist we want to search when we search
			myFieldsToSearch: ['Keywords', 'Description'],
			myFieldsCss: [
				{ id: 'productsVendor', class: 'view-tiny' },
				{ id: 'productsMulti', class: 'view-tiny' },
				{ id: 'productsCost', class: 'view-medium' },
				{ id: 'productsFreight', class: 'view-small' },
				{ id: 'productsReturn', class: 'view-medium' },
				{ id: 'productsComments', class: 'view-medium' },
				{ id: 'productsKeys', class: '' },
				{ id: 'vdlistEdit', class: 'view-show-all' },
			],
			myName: 'Product Line List',
			relativeList: '/sites/Sales/Lists/Product%20Line%20List/Default%20View.aspx',
			relativeItem: '/sites/Sales/Lists/Product%20Line%20List/DispForm.aspx?ID='
		},
	};

	function findManufactureRep(objItem) {
		if(objItem.hasOwnProperty('ManufacturerRep0Id')) 
			return mrlistReferenceMaster.find( (e) => e.Id == objItem.ManufacturerRep0Id ) || "Not Found"
		else
			return mrlistReferenceMaster.find( (e) => e.Id == objItem.ManufacturerRepId ) || "Not Found"
	}

	function findVendor(objItem, opts) {
		if(objItem.hasOwnProperty('Vendor_x0020_Name0Id')) 
			return vlistReferenceMaster.find( (e) => e.Id == opts.many ) || "Not Found"
		else if (objItem.hasOwnProperty('Vendor_x0020_NameId'))
			return vlistReferenceMaster.find( (e) => e.Id == objItem.Vendor_x0020_NameId ) || null
		else 
			return vlistReferenceMaster.find( (e) => e.Id == objItem.Vendor_x0020_Name_x0020_NEWId ) || "Not Found"
	}

	function findManyVendors(objItem) {
		var temp = [];
		if (objItem.Vendor_x0020_Name0Id.results.length > 0){
			var j = objItem.Vendor_x0020_Name0Id.results.length;
			while (--j >= 0){
				temp.push(findVendor(objItem,{many: objItem.Vendor_x0020_Name0Id.results[j]}))
			}
		}

		return temp || "Not Found";
	}

	function findEditor(objItem) {
		return usersReferenceMaster.find( e => e.Id == objItem.EditorId ) || null
	}

	function circleSearch(text) {
		$('#searchInput').val(String(text));
		doSearch();
	}

	async function vlistSearch() {
		$('#vlistBody tr').remove();
		$('#vlistBody').append( SPINNER );
		$('#vlistTitle').next('div').show('slow'); $(this).find('.arrow').toggleClass('active');
		Promise.resolve().then( () => {
			var input = $('#searchInput').val();
			var search = ListMaster.vlist;
			// set up Query Filter
			search.queryFilter = '';
			if(input.length <= 0) {/* Don't set up a query filter */}
			else {
				search.myFieldsToSearch.forEach( (element, index, arr) => { 
					index !== (arr.length - 1)
					? search.queryFilter += "substringof('" + input +"',"+ element +") or "
					: search.queryFilter += "substringof('" + input +"',"+ element +")";
				});
				// handle 2ndary search for Manufacturer Reps Names by ID
				var k = mrlistReferenceMaster.length;
				while (--k >= 0){
					if (mrlistReferenceMaster[k].ManufacturerRep.toUpperCase().includes(input.toUpperCase()))
						search.queryFilter += " or ManufacturerRep0Id eq " + mrlistReferenceMaster[k].Id
				}
			}
		// Query Vendor List
			sprLib.list(ListMaster.vlist.myName)
		      .items(ListMaster.vlist)
		      .then(objList => {
		      	$('#vlistBody tr').remove();
		      	var table = $('#vlistBody');
		      	
		      	if (objList.length > 0) {
			      	objList.forEach((element, index) => {
			      		var append = '<tr id="vlistRow' + index + '">';
			      		var keys = Object.keys(element);
			      		var f = keys.indexOf('__next');
			      		if(f >= 0 && f < keys.length) { keys.splice(f,1); }
			      		keys.slice(2).sort().forEach((el, idx, arr) => {
				      		append += '<td id="' + ListMaster.vlist.myFieldsCss[idx].id + index 
					      			+ '" class="' + ListMaster.vlist.myFieldsCss[idx].class + '">'

					      	switch(idx){
					      		// case 0: //LOGO
					      		// 	if(element[el])
						      	// 		append += '<img style="" src="' + (element[el].Url || "") + '"></td>';
						      	// 	else
						      	// 		append += '<img style="" src=""></td>';
					      		// 	break;
					      		case 0: //VENDOR NAME
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
						      				+ '<a href="' + ListMaster.vlist.relativeItem + element['a'] + '" target="_blank" >'
					      					+ (element[el] || "") + '</a></p></td>';
					      			break;
					      		case 1: //VENDOR #
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
						      				+ '<a href="' + ListMaster.vlist.relativeItem + element['a'] + '" target="_blank" >'
					      					+ (element[el] || "") + '</a></p></td>';
					      			break;	
					      		case 5: //MANREP
					      			if (element[el].Id){
						      		    append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      					+ '<a href="#" onclick="circleSearch(\''+ element[el].ManufacturerRep + '\')" >'
					      					+ element[el].ManufacturerRep + '</a></p></td>'
					      			}
					      			else
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      			break;
					      		case 6://WEBSITE
					      			if (element[el]) {
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      					+ '<a href="' + (element[el] || "") + '" target="_blank" >'
					      					+ (element[el] || "") + '</a></p></td>'
					      			}
					      			else
					      				append +='<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      			break;
					      		case (arr.length-1):
				      				append += '<div class="mbr-col mbr-section-btn align-center field">' 
					      				+ '<a href="' + (element[el] || "") + '" target="_blank"  class="btn-sm btn-form btn-info-outline display-4">'
					      				+  '<span class="mbri-share mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M23.333 1.333c-0.368 0-0.667 0.313-0.667 0.667v4.667c-1.924 0.138-3.319 0.538-5.305 2.362s-2.699 5.131-2.695 7.638c0.001 0.775 1.106 0.92 1.31 0.172 0.648-2.42 2.423-3.591 4.122-4.214 1.35-0.494 2.112-0.475 2.568-0.497v4.539c-0.001 0.58 0.689 0.884 1.117 0.492l8-7.333c0.289-0.264 0.289-0.72 0-0.984l-8-7.333c-0.133-0.122-0.27-0.185-0.451-0.174zM24 3.516l6.346 5.818-6.346 5.818v-3.818c-0-0.368-0.299-0.667-0.667-0.667 0 0-1.75-0.003-3.693 0.708-1.077 0.394-2.176 1.118-3.133 2.102 0.402-1.454 0.768-2.477 1.797-3.505s3.177-1.971 5.029-1.971c0.368-0 0.667-0.298 0.667-0.667zM2 8c-1.096 0-2 0.904-2 2v18.667c0 	1.096 0.904 2 2 2h26.667c1.096 0 2-0.904 2-2v-12c0.013-0.902-1.346-0.902-1.333 0v12c0 0.381-0.286 0.667-0.667 0.667h-26.667c-0.381 0-0.667-0.286-0.667-0.667v-18.667c0-0.381 0.286-0.667 0.667-0.667h12c0.912 0 0.85-1.333 0-1.333z"></path></svg></span></a></div>' + '</td>';
					      			break;
					      		default:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ (element[el] || "") + '</p>' + '</td>';
					      	}
					     });
						append += '</tr>';
				      	table.append(append);	
			      	});
		      }
		      else {
				table.append('<tr><td colspan="12"> (No Results Found) </td></tr>');
		      }
		      })
		      .catch(err => {$('#vlistBody tr').remove();$('#vlistBody').append('<tr><td colspan="12">An Error occurred: '+err+'</td></tr>')} );
		})
	}

	async function vclistSearch() {
		$('#vclistBody tr').remove();
		$('#vclistBody').append( SPINNER );
		$('#vclistTitle').next('div').show('slow'); $(this).find('.arrow').toggleClass('active');
		Promise.resolve().then( () => {
			var input = $('#searchInput').val();
			var search = ListMaster.vclist;
		// set up Query Filter
			search.queryFilter = '';
			if(input.length <= 0) {/* Don't set up a query filter */}
			else {
				search.myFieldsToSearch.forEach( (element, index, arr) => { 
					index !== (arr.length - 1)
					? search.queryFilter += "substringof('" + input +"',"+ element +") or "
					: search.queryFilter += "substringof('" + input +"',"+ element +")";
				});
				// handle 2ndary search for Vendor Names by ID
				var k = vlistReferenceMaster.length;
				while (--k >= 0){
					if (vlistReferenceMaster[k].Title.toUpperCase().includes(input.toUpperCase()) || vlistReferenceMaster[k].VendorNum == input )
						search.queryFilter += " or Vendor_x0020_Name_x0020_NEWId eq " + vlistReferenceMaster[k].Id
				}
			}
		// Query List
			sprLib.list(ListMaster.vclist.myName)
		      .items(ListMaster.vclist)
		      .then(objList => {
		      	$('#vclistBody tr').remove();
		      	var table = $('#vclistBody');

		      	if (objList.length > 0) {
			      	objList.forEach((element, index) => {
			      		var append = '<tr id="vclistRow' + index + '">';
			      		var keys = Object.keys(element);
			      		var f = keys.indexOf('__next');
			      		if(f >= 0 && f < keys.length) { keys.splice(f,1); }
			      		keys.slice(2).forEach((el, idx, arr) => {
				      		append += '<td id="' + ListMaster.vclist.myFieldsCss[idx].id + index 
					      			+ '" class="' + ListMaster.vclist.myFieldsCss[idx].class + '">'

					      	switch(idx){
					      		case 3://HANDLE EMAIL LINK
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ '<a href="https://outlook.office.com/mail/deeplink/compose?to='+ (element[el] || "") + '" target="_blank">' 
					      				+ (element[el] || "") + '</a></p>' + '</td>';
					      			break;
					      		// HANDLE VENDOR && VENDOR NUMBER
					      		case 7: 
					      		    append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
				      						+ '<a href="#" onclick="circleSearch(\'' + element[el].Title + '\')" >'
				      						+ (element[el].Title || "") + '</a></p></td>';
				      				append += '<td id="" class="' + ListMaster.vclist.myFieldsCss[idx].class + '">'
					      				   	+ '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				   	+ '<a href="#" onclick="circleSearch(\'' + element[el].VendorNum + '\')" >'
				      					   	+ (element[el].VendorNum || "") + '</a></p></td>';
					      			break;
				      			// HANDLE EDIT LINK
					      		case (arr.length-1):
				      				append += '<div class="mbr-col mbr-section-btn align-center field">' 
					      				+ '<a href="' + (element[el] || "") + '" target="_blank"  class="btn-sm btn-form btn-info-outline display-4">'
					      				+  '<span class="mbri-share mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M23.333 1.333c-0.368 0-0.667 0.313-0.667 0.667v4.667c-1.924 0.138-3.319 0.538-5.305 2.362s-2.699 5.131-2.695 7.638c0.001 0.775 1.106 0.92 1.31 0.172 0.648-2.42 2.423-3.591 4.122-4.214 1.35-0.494 2.112-0.475 2.568-0.497v4.539c-0.001 0.58 0.689 0.884 1.117 0.492l8-7.333c0.289-0.264 0.289-0.72 0-0.984l-8-7.333c-0.133-0.122-0.27-0.185-0.451-0.174zM24 3.516l6.346 5.818-6.346 5.818v-3.818c-0-0.368-0.299-0.667-0.667-0.667 0 0-1.75-0.003-3.693 0.708-1.077 0.394-2.176 1.118-3.133 2.102 0.402-1.454 0.768-2.477 1.797-3.505s3.177-1.971 5.029-1.971c0.368-0 0.667-0.298 0.667-0.667zM2 8c-1.096 0-2 0.904-2 2v18.667c0 	1.096 0.904 2 2 2h26.667c1.096 0 2-0.904 2-2v-12c0.013-0.902-1.346-0.902-1.333 0v12c0 0.381-0.286 0.667-0.667 0.667h-26.667c-0.381 0-0.667-0.286-0.667-0.667v-18.667c0-0.381 0.286-0.667 0.667-0.667h12c0.912 0 0.85-1.333 0-1.333z"></path></svg></span></a></div>' + '</td>';
					      			break;
					      		default:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ (element[el] || "") + '</p>' + '</td>';
					      	}
					     });
						append += '</tr>';
				      	table.append(append);	
			      	});
			    }
			    else {
				    table.append('<tr><td colspan="11"> (No Results Found) </td></tr>');
			    }
			  })
		      .catch(err => {$('#vclistBody tr').remove();$('#vclistBody').append('<tr><td colspan="12">An Error occurred: '+err+'</td></tr>')} );
		})
	}

	async function mrlistSearch() {
		$('#mrlistBody tr').remove();
		$('#mrlistBody').append( SPINNER );
		$('#mrlistTitle').next('div').show('slow'); $(this).find('.arrow').toggleClass('active');
		Promise.resolve().then( () => {
			var input = $('#searchInput').val();
			var search = ListMaster.mrlist;
		// set up Query Filter
			search.queryFilter = '';
			if(input.length <= 0) {/* Don't set up a query filter */}
			else {
				search.myFieldsToSearch.forEach( (element, index, arr) => { 
					index !== (arr.length - 1)
					? search.queryFilter += "substringof('" + input +"',"+ element +") or "
					: search.queryFilter += "substringof('" + input +"',"+ element +")";
				});
				// handle 2ndary search for Vendor Names by ID
				var k = vlistReferenceMaster.length;
				while (--k >= 0){
					if (vlistReferenceMaster[k].Title.toUpperCase().includes(input.toUpperCase()) || vlistReferenceMaster[k].VendorNum == input )
						search.queryFilter += " or Vendor_x0020_Name0Id eq " + vlistReferenceMaster[k].Id
				}
			}
		// Query List
			sprLib.list(ListMaster.mrlist.myName)
		      .items(ListMaster.mrlist)
		      .then(objList => {
		      	$('#mrlistBody tr').remove();
		      	var table = $('#mrlistBody');

		      	if (objList.length > 0) {
			      	objList.forEach((element, index) => {
			      		var append = '<tr id="mrlistRow' + index + '">';
			      		var keys = Object.keys(element);
			      		var f = keys.indexOf('__next');
			      		if(f >= 0 && f < keys.length) { keys.splice(f,1); }
			      		keys.slice(2).forEach((el, idx, arr) => {
				      		append += '<td id="' + ListMaster.mrlist.myFieldsCss[idx].id + index 
					      			+ '" class="' + ListMaster.mrlist.myFieldsCss[idx].class + '">'

					      	switch(idx){
					      		// case 0: // LOGO
					      		// 	if(element[el])
						      	// 		append += '<img style="" src="' + (element[el].Url || "") + '"></td>';
						      	// 	else
						      	// 		append += '<img style="" src=""></td>';
					      		// 	break;
					      		case 0:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
						      				+ '<a href="' + ListMaster.mrlist.relativeItem + element['a'] + '" target="_blank" >'
					      					+ (element[el] || "") + '</a></p></td>';
					      			break; 
					      		case 3: // HANDLE VENDOR && VENDOR NUMBER
					      			if (element[el]){
					      				var appendNum = '<td id="" class="' + ListMaster.mrlist.myFieldsCss[idx].class + '">'
					      				   			  + '<p class="mbr-text mbr-fonts-style align-center display-7">';
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7">';
					      				element[el].forEach( (e, i ,a) => {
					      					append += '<a href="#" onclick="circleSearch(\'' + e.Title +'\')" >'
				      								+ (e.Title || "") + '</a>' + '&nbsp;&nbsp;';
				      						appendNum += '<a href="#" onclick="circleSearch(\'' + e.VendorNum +'\')" >'
				      					   			  + (e.VendorNum || "") + '</a>' + '&nbsp;&nbsp;';
					      				});
					      				append += '</p></td>';
					      				append += appendNum + '</p></td>';
					      			}
					      		    else {
					      		    	append += '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    	append += '<td id="" class="' + ListMaster.mrlist.myFieldsCss[idx].class + '">'
					      		    		   	+ '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    }
					      			break;
					      		case (arr.length-1): // HANDLE EDIT LINK
				      				append += '<div class="mbr-col mbr-section-btn align-center field">' 
					      				+ '<a href="' + (element[el] || "") + '" target="_blank"  class="btn-sm btn-form btn-info-outline display-4">'
					      				+  '<span class="mbri-share mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M23.333 1.333c-0.368 0-0.667 0.313-0.667 0.667v4.667c-1.924 0.138-3.319 0.538-5.305 2.362s-2.699 5.131-2.695 7.638c0.001 0.775 1.106 0.92 1.31 0.172 0.648-2.42 2.423-3.591 4.122-4.214 1.35-0.494 2.112-0.475 2.568-0.497v4.539c-0.001 0.58 0.689 0.884 1.117 0.492l8-7.333c0.289-0.264 0.289-0.72 0-0.984l-8-7.333c-0.133-0.122-0.27-0.185-0.451-0.174zM24 3.516l6.346 5.818-6.346 5.818v-3.818c-0-0.368-0.299-0.667-0.667-0.667 0 0-1.75-0.003-3.693 0.708-1.077 0.394-2.176 1.118-3.133 2.102 0.402-1.454 0.768-2.477 1.797-3.505s3.177-1.971 5.029-1.971c0.368-0 0.667-0.298 0.667-0.667zM2 8c-1.096 0-2 0.904-2 2v18.667c0 	1.096 0.904 2 2 2h26.667c1.096 0 2-0.904 2-2v-12c0.013-0.902-1.346-0.902-1.333 0v12c0 0.381-0.286 0.667-0.667 0.667h-26.667c-0.381 0-0.667-0.286-0.667-0.667v-18.667c0-0.381 0.286-0.667 0.667-0.667h12c0.912 0 0.85-1.333 0-1.333z"></path></svg></span></a></div>' + '</td>';
					      			break;
					      		default:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ (element[el] || "") + '</p>' + '</td>';
					      	}
					     });
						append += '</tr>';
				      	table.append(append);	
			      	});
			    }
			    else {
				    table.append('<tr><td colspan="11"> (No Results Found) </td></tr>');
			    }
			  })
		      .catch(err => {$('#mrlistBody tr').remove();$('#mrlistBody').append('<tr><td colspan="12">An Error occurred: '+err+'</td></tr>')} );
		})
	}

	async function mrclistSearch() {
		$('#mrclistBody tr').remove();
		$('#mrclistBody').append( SPINNER );
		$('#mrclistTitle').next('div').show('slow'); $(this).find('.arrow').toggleClass('active');
		Promise.resolve().then( () => {
			var input = $('#searchInput').val();
			var search = ListMaster.mrclist;
		// set up Query Filter
			search.queryFilter = '';
			if(input.length <= 0) {/* Don't set up a query filter */}
			else {
				search.myFieldsToSearch.forEach( (element, index, arr) => { 
					index !== (arr.length - 1)
					? search.queryFilter += "substringof('" + input +"',"+ element +") or "
					: search.queryFilter += "substringof('" + input +"',"+ element +")";
				});
				// handle 2ndary search for Vendor Names by ID
				var k = vlistReferenceMaster.length;
				while (--k >= 0){
					if (vlistReferenceMaster[k].Title.toUpperCase().includes(input.toUpperCase()) || vlistReferenceMaster[k].VendorNum == input )
						search.queryFilter += " or Vendor_x0020_Name0Id eq " + vlistReferenceMaster[k].Id
				}
				// handle 2ndary search for Manufacturer Reps Names by ID
				k = mrlistReferenceMaster.length;
				while (--k >= 0){
					if (mrlistReferenceMaster[k].ManufacturerRep.toUpperCase().includes(input.toUpperCase()))
						search.queryFilter += " or ManufacturerRepId eq " + mrlistReferenceMaster[k].Id
				} 
			}
		// Query List
			sprLib.list(ListMaster.mrclist.myName)
		      .items(ListMaster.mrclist)
		      .then(objList => {
		      	$('#mrclistBody tr').remove();
		      	var table = $('#mrclistBody');

		      	if (objList.length > 0) {
			      	objList.forEach((element, index) => {
			      		var append = '<tr id="mrclistRow' + index + '">';
			      		var keys = Object.keys(element);
			      		var f = keys.indexOf('__next');
			      		if(f >= 0 && f < keys.length) { keys.splice(f,1); }
			      		keys.slice(3).forEach((el, idx, arr) => {
				      		append += '<td id="' + ListMaster.mrclist.myFieldsCss[idx].id + index 
					      			+ '" class="' + ListMaster.mrclist.myFieldsCss[idx].class + '">'

					      	switch(idx){
					      		case 3://HANDLE EMAIL LINK
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ '<a href="https://outlook.office.com/mail/deeplink/compose?to='+ (element[el] || "") + '" target="_blank">' 
					      				+ (element[el] || "") + '</a></p>' + '</td>';
					      			break;
					      		case 6: // HANDLE MANREP
					      			if (element[el].Id){
						      		    append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      					+ '<a href="#" onclick="circleSearch(\'' + element[el].ManufacturerRep + '\')" >'
					      					+ element[el].ManufacturerRep + '</a></p></td>';
					      			}
					      			else
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      			break;
					      		case 7: // HANDLE VENDOR && VENDOR NUMBER
					      			if (element[el]){
					      				var appendNum = '<td id="" class="' + ListMaster.mrclist.myFieldsCss[idx].class + '">'
					      				   			  + '<p class="mbr-text mbr-fonts-style align-center display-7">';
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7">';
					      				element[el].forEach( (e, i ,a) => {
					      					append += '<a href="#" onclick="circleSearch(\'' + e.Title +'\')" >'
				      								+ (e.Title || "") + '</a>' + '&nbsp;&nbsp;';
				      						appendNum += '<a href="#" onclick="circleSearch(\'' + e.VendorNum +'\')" >'
				      					   			  + (e.VendorNum || "") + '</a>' + '&nbsp;&nbsp;';
					      				});
					      				append += '</p></td>';
					      				append += appendNum + '</p></td>';
					      			}
					      		    else {
					      		    	append += '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    	append += '<td id="" class="">'
					      		    		   	+ '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    }
					      			break;
					      		case (arr.length-1): // HANDLE EDIT LINK
				      				append += '<div class="mbr-col mbr-section-btn align-center field">' 
					      				+ '<a href="' + (element[el] || "") + '" target="_blank"  class="btn-sm btn-form btn-info-outline display-4">'
					      				+  '<span class="mbri-share mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M23.333 1.333c-0.368 0-0.667 0.313-0.667 0.667v4.667c-1.924 0.138-3.319 0.538-5.305 2.362s-2.699 5.131-2.695 7.638c0.001 0.775 1.106 0.92 1.31 0.172 0.648-2.42 2.423-3.591 4.122-4.214 1.35-0.494 2.112-0.475 2.568-0.497v4.539c-0.001 0.58 0.689 0.884 1.117 0.492l8-7.333c0.289-0.264 0.289-0.72 0-0.984l-8-7.333c-0.133-0.122-0.27-0.185-0.451-0.174zM24 3.516l6.346 5.818-6.346 5.818v-3.818c-0-0.368-0.299-0.667-0.667-0.667 0 0-1.75-0.003-3.693 0.708-1.077 0.394-2.176 1.118-3.133 2.102 0.402-1.454 0.768-2.477 1.797-3.505s3.177-1.971 5.029-1.971c0.368-0 0.667-0.298 0.667-0.667zM2 8c-1.096 0-2 0.904-2 2v18.667c0 	1.096 0.904 2 2 2h26.667c1.096 0 2-0.904 2-2v-12c0.013-0.902-1.346-0.902-1.333 0v12c0 0.381-0.286 0.667-0.667 0.667h-26.667c-0.381 0-0.667-0.286-0.667-0.667v-18.667c0-0.381 0.286-0.667 0.667-0.667h12c0.912 0 0.85-1.333 0-1.333z"></path></svg></span></a></div>' + '</td>';
					      			break;
					      		default:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ (element[el] || "") + '</p>' + '</td>';
					      	}

					     });
						append += '</tr>';
				      	table.append(append);	
			      	});
			    }
			    else {
				    table.append('<tr><td colspan="11"> (No Results Found) </td></tr>');
			    }
			  })
		      .catch(err => {$('#mrclistBody tr').remove();$('#mrclistBody').append('<tr><td colspan="12">An Error occurred: '+err+'</td></tr>')} );
		})
	}

	async function vdlistSearch() {
		$('#vdlistBody tr').remove();
		$('#vdlistBody').append( SPINNER );
		$('#vdlistTitle').next('div').show('slow'); $(this).find('.arrow').toggleClass('active');
		Promise.resolve().then( () => {
			var input = $('#searchInput').val();
			var search = ListMaster.vdlist;
		// set up Query Filter
			search.queryFilter = '';
			if(input.length <= 0) {/* Don't set up a query filter */}
			else {
				search.myFieldsToSearch.forEach( (element, index, arr) => { 
					index !== (arr.length - 1)
					? search.queryFilter += "substringof('" + input +"',"+ element +") or "
					: search.queryFilter += "substringof('" + input +"',"+ element +")";
				});
				// handle 2ndary search for Vendor Names by ID
				var k = vlistReferenceMaster.length;
				while (--k >= 0){
					if (vlistReferenceMaster[k].Title.toUpperCase().includes(input.toUpperCase()) || vlistReferenceMaster[k].VendorNum == input )
						search.queryFilter += " or Vendor_x0020_Name0Id eq " + vlistReferenceMaster[k].Id
				}
			}
		// Query List
			sprLib.list(ListMaster.vdlist.myName)
		      .items(ListMaster.vdlist)
		      .then(objList => {
		      	$('#vdlistBody tr').remove();
		      	var table = $('#vdlistBody');

		      	if (objList.length > 0) {
			      	objList.forEach((element, index) => {
			      		var append = '<tr id="vdlistRow' + index + '">';
			      		var keys = Object.keys(element);
			      		var f = keys.indexOf('__next');
			      		if(f >= 0 && f < keys.length) { keys.splice(f,1); }
			      		keys.slice(3).forEach((el, idx, arr) => {
				      		append += '<td id="' + ListMaster.vdlist.myFieldsCss[idx].id + index 
					      			+ '" class="' + ListMaster.vdlist.myFieldsCss[idx].class + '">'

					      	switch(idx){
					      		case 0: 
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      					+ '<a href="' + (element[arr[arr.length-1]] || "") + '" target="_blank">' + (element[el] || "") + '</p>' + '</td>';
					      			
					      			break;
					      		case 2: // HANDLE VENDOR && VENDOR NUMBER
					      			if (element[el]){
					      				var appendNum = '<td id="" class="' + ListMaster.vdlist.myFieldsCss[idx].class + '">'
					      				   			  + '<p class="mbr-text mbr-fonts-style align-center display-7">';
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7">';
					      				element[el].forEach( (e, i ,a) => {
					      					append += '<a href="#" onclick="circleSearch(\'' + e.Title +'\')" >'
				      								+ (e.Title || "") + '</a>' + '&nbsp;&nbsp;';
				      						appendNum += '<a href="#" onclick="circleSearch(\'' + e.VendorNum +'\')" >'
				      					   			  + (e.VendorNum || "") + '</a>' + '&nbsp;&nbsp;';
					      				});
					      				append += '</p></td>';
					      				append += appendNum + '</p></td>';
					      			}
					      		    else {
					      		    	append += '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    	append += '<td id="" class="' + ListMaster.vdlist.myFieldsCss[idx].class + '">'
					      		    		   	+ '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    }
					      			break;
					      		case 3: // HANDLE MODIFIED
									 append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					    					+ element[el].Title || "" + '</p>' + '</td>';
				      				break;
				      			case 4:
				      				append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
				      						+ new Date(element[el]).toLocaleDateString('en-US', {weekday: "long", year: 'numeric', month: 'long', day: 'numeric'})
				      						+ '</p>' + '</td>';
				      				break;
					      		case (arr.length-1): // HANDLE EDIT LINK
				      				append += '<div class="mbr-col mbr-section-btn align-center field">' 
					      				+ '<a href="' + (element[el] || "") + '" target="_blank"  class="btn-sm btn-form btn-info-outline display-4">'
					      				+  '<span class="mbri-share mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M23.333 1.333c-0.368 0-0.667 0.313-0.667 0.667v4.667c-1.924 0.138-3.319 0.538-5.305 2.362s-2.699 5.131-2.695 7.638c0.001 0.775 1.106 0.92 1.31 0.172 0.648-2.42 2.423-3.591 4.122-4.214 1.35-0.494 2.112-0.475 2.568-0.497v4.539c-0.001 0.58 0.689 0.884 1.117 0.492l8-7.333c0.289-0.264 0.289-0.72 0-0.984l-8-7.333c-0.133-0.122-0.27-0.185-0.451-0.174zM24 3.516l6.346 5.818-6.346 5.818v-3.818c-0-0.368-0.299-0.667-0.667-0.667 0 0-1.75-0.003-3.693 0.708-1.077 0.394-2.176 1.118-3.133 2.102 0.402-1.454 0.768-2.477 1.797-3.505s3.177-1.971 5.029-1.971c0.368-0 0.667-0.298 0.667-0.667zM2 8c-1.096 0-2 0.904-2 2v18.667c0 	1.096 0.904 2 2 2h26.667c1.096 0 2-0.904 2-2v-12c0.013-0.902-1.346-0.902-1.333 0v12c0 0.381-0.286 0.667-0.667 0.667h-26.667c-0.381 0-0.667-0.286-0.667-0.667v-18.667c0-0.381 0.286-0.667 0.667-0.667h12c0.912 0 0.85-1.333 0-1.333z"></path></svg></span></a></div>' + '</td>';
					      			break;
					      		default:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ (element[el] || "") + '</p>' + '</td>';
					      	}
					     });
						append += '</tr>';
				      	table.append(append);	
			      	});
			    }
			    else {
				    table.append('<tr><td colspan="11"> (No Results Found) </td></tr>');
			    }
			  })
		      .catch(err => {$('#vdlistBody tr').remove();$('#vdlistBody').append('<tr><td colspan="12">An Error occurred: '+err+'</td></tr>')} );
		})
	}

	async function vdetailsSearch() {
		$('#vdetailsBody tr').remove();
		$('#vdetailsBody').append( SPINNER );
		$('#vdetailsTitle').next('div').show('slow'); $(this).find('.arrow').toggleClass('active');
		Promise.resolve().then( () => {
			var input = $('#searchInput').val();
			var search = ListMaster.vdetails;
		// set up Query Filter
			search.queryFilter = '';
			if(input.length <= 0) {/* Don't set up a query filter */}
			else {
				search.myFieldsToSearch.forEach( (element, index, arr) => { 
					index !== (arr.length - 1)
					? search.queryFilter += "substringof('" + input +"',"+ element +") or "
					: search.queryFilter += "substringof('" + input +"',"+ element +")";
				});
				// handle 2ndary search for Vendor Names by ID
				var k = vlistReferenceMaster.length;
				while (--k >= 0){
					if (vlistReferenceMaster[k].Title.toUpperCase().includes(input.toUpperCase()) || vlistReferenceMaster[k].VendorNum == input )
						search.queryFilter += " or Vendor_x0020_NameId eq " + vlistReferenceMaster[k].Id
				}
			}
		// Query List
			sprLib.list(ListMaster.vdetails.myName)
		      .items(ListMaster.vdetails)
		      .then(objList => {
		      	$('#vdetailsBody tr').remove();
		      	var table = $('#vdetailsBody');

		      	if (objList.length > 0) {
			      	objList.forEach((element, index) => {
			      		var append = '<tr id="vdetailsRow' + index + '">';
			      		var keys = Object.keys(element);
			      		var f = keys.indexOf('__next');
			      		if(f >= 0 && f < keys.length) { keys.splice(f,1); }
			      		keys.slice(2).forEach((el, idx, arr) => {
				      		append += '<td id="' + ListMaster.vdetails.myFieldsCss[idx].id + index 
					      			+ '" class="' + ListMaster.vdetails.myFieldsCss[idx].class + '">'

					      	switch(idx){ 
					      		case 0: // HANDLE VENDOR && VENDOR NUMBER
					      			if (element[el]){
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      						+ '<a href="#" onclick="circleSearch(\'' + element[el].Title +'\')" >'
					      						+ (element[el].Title || "") + '</a></p></td>';
					      				append += '<td id="" class="' + ListMaster.vclist.myFieldsCss[idx].class + '">'
						      				   	+ '<p class="mbr-text mbr-fonts-style align-center display-7">'
						      				   	+ '<a href="#" onclick="circleSearch(\'' + element[el].VendorNum +'\')" >'
					      					   	+ (element[el].VendorNum || "") + '</a></p></td>';
					      			}
					      		    else {
					      		    	append += '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    	append += '<td id="" class="' + ListMaster.vdetails.myFieldsCss[idx].class + '">'
					      		    		   	+ '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    }
					      			break;
					      		case (arr.length-1): // HANDLE EDIT LINK
				      				append += '<div class="mbr-col mbr-section-btn align-center field">' 
					      				+ '<a href="' + (element[el] || "") + '" target="_blank"  class="btn-sm btn-form btn-info-outline display-4">'
					      				+  '<span class="mbri-share mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M23.333 1.333c-0.368 0-0.667 0.313-0.667 0.667v4.667c-1.924 0.138-3.319 0.538-5.305 2.362s-2.699 5.131-2.695 7.638c0.001 0.775 1.106 0.92 1.31 0.172 0.648-2.42 2.423-3.591 4.122-4.214 1.35-0.494 2.112-0.475 2.568-0.497v4.539c-0.001 0.58 0.689 0.884 1.117 0.492l8-7.333c0.289-0.264 0.289-0.72 0-0.984l-8-7.333c-0.133-0.122-0.27-0.185-0.451-0.174zM24 3.516l6.346 5.818-6.346 5.818v-3.818c-0-0.368-0.299-0.667-0.667-0.667 0 0-1.75-0.003-3.693 0.708-1.077 0.394-2.176 1.118-3.133 2.102 0.402-1.454 0.768-2.477 1.797-3.505s3.177-1.971 5.029-1.971c0.368-0 0.667-0.298 0.667-0.667zM2 8c-1.096 0-2 0.904-2 2v18.667c0 	1.096 0.904 2 2 2h26.667c1.096 0 2-0.904 2-2v-12c0.013-0.902-1.346-0.902-1.333 0v12c0 0.381-0.286 0.667-0.667 0.667h-26.667c-0.381 0-0.667-0.286-0.667-0.667v-18.667c0-0.381 0.286-0.667 0.667-0.667h12c0.912 0 0.85-1.333 0-1.333z"></path></svg></span></a></div>' + '</td>';
					      			break;
					      		default:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ (element[el] || "") + '</p>' + '</td>';
					      	}
					     });
						append += '</tr>';
				      	table.append(append);	
			      	});
			    }
			    else {
				    table.append('<tr><td colspan="11"> (No Results Found) </td></tr>');
			    }
			  })
		      .catch(err => {$('#vdetailsBody tr').remove();$('#vdetailsBody').append('<tr><td colspan="12">An Error occurred: '+err+'</td></tr>')} );
		})
	}

	async function productsSearch() {
		$('#productsBody tr').remove();
		$('#productsBody').append( SPINNER );
		$('#productsTitle').next('div').show('slow'); $(this).find('.arrow').toggleClass('active');
		Promise.resolve().then( () => {
			var input = $('#searchInput').val();
			var search = ListMaster.products;
		// set up Query Filter
			search.queryFilter = '';
			if(input.length <= 0) {/* Don't set up a query filter */}
			else {
				search.myFieldsToSearch.forEach( (element, index, arr) => { 
					index !== (arr.length - 1)
					? search.queryFilter += "substringof('" + input +"',"+ element +") or "
					: search.queryFilter += "substringof('" + input +"',"+ element +")";
				});
				// handle 2ndary search for Vendor Names by ID
				var k = vlistReferenceMaster.length;
				while (--k >= 0){
					if (vlistReferenceMaster[k].Title.toUpperCase().includes(input.toUpperCase()) || vlistReferenceMaster[k].VendorNum == input )
						search.queryFilter += " or Vendor_x0020_NameId eq " + vlistReferenceMaster[k].Id
				}
			}
		// Query List
			sprLib.list(ListMaster.products.myName)
		      .items(ListMaster.products)
		      .then(objList => {
		      	$('#productsBody tr').remove();
		      	var table = $('#productsBody');

		      	if (objList.length > 0) {
			      	objList.forEach((element, index) => {
			      		var append = '<tr id="productsRow' + index + '">';
			      		var keys = Object.keys(element);
			      		var f = keys.indexOf('__next');
			      		if(f >= 0 && f < keys.length) { keys.splice(f,1); }
			      		keys.slice(2).forEach((el, idx, arr) => {
				      		append += '<td id="' + ListMaster.products.myFieldsCss[idx].id + index 
					      			+ '" class="' + ListMaster.products.myFieldsCss[idx].class + '">'

					      	switch(idx){ 
					      		case 0: // HANDLE VENDOR && VENDOR NUMBER
					      			if (element[el]){
					      				append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      						+ '<a href="#" onclick="circleSearch(\'' + element[el].Title +'\')" >'
					      						+ (element[el].Title || "") + '</a></p></td>';
					      				append += '<td id="" class="' + ListMaster.vclist.myFieldsCss[idx].class + '">'
						      				   	+ '<p class="mbr-text mbr-fonts-style align-center display-7">'
						      				   	+ '<a href="#" onclick="circleSearch(\'' + element[el].VendorNum +'\')" >'
					      					   	+ (element[el].VendorNum || "") + '</a></p></td>';
					      			}
					      		    else {
					      		    	append += '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    	append += '<td id="" class="' + ListMaster.products.myFieldsCss[idx].class + '">'
					      		    		   	+ '<p class="mbr-text mbr-fonts-style align-center display-7"></p></td>'
					      		    }
					      			break;
					      		case (arr.length-1): // HANDLE EDIT LINK
				      				append += '<div class="mbr-col mbr-section-btn align-center field">' 
					      				+ '<a href="' + (element[el] || "") + '" target="_blank"  class="btn-sm btn-form btn-info-outline display-4">'
					      				+  '<span class="mbri-share mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M23.333 1.333c-0.368 0-0.667 0.313-0.667 0.667v4.667c-1.924 0.138-3.319 0.538-5.305 2.362s-2.699 5.131-2.695 7.638c0.001 0.775 1.106 0.92 1.31 0.172 0.648-2.42 2.423-3.591 4.122-4.214 1.35-0.494 2.112-0.475 2.568-0.497v4.539c-0.001 0.58 0.689 0.884 1.117 0.492l8-7.333c0.289-0.264 0.289-0.72 0-0.984l-8-7.333c-0.133-0.122-0.27-0.185-0.451-0.174zM24 3.516l6.346 5.818-6.346 5.818v-3.818c-0-0.368-0.299-0.667-0.667-0.667 0 0-1.75-0.003-3.693 0.708-1.077 0.394-2.176 1.118-3.133 2.102 0.402-1.454 0.768-2.477 1.797-3.505s3.177-1.971 5.029-1.971c0.368-0 0.667-0.298 0.667-0.667zM2 8c-1.096 0-2 0.904-2 2v18.667c0 	1.096 0.904 2 2 2h26.667c1.096 0 2-0.904 2-2v-12c0.013-0.902-1.346-0.902-1.333 0v12c0 0.381-0.286 0.667-0.667 0.667h-26.667c-0.381 0-0.667-0.286-0.667-0.667v-18.667c0-0.381 0.286-0.667 0.667-0.667h12c0.912 0 0.85-1.333 0-1.333z"></path></svg></span></a></div>' + '</td>';
					      			break;
					      		default:
					      			append += '<p class="mbr-text mbr-fonts-style align-center display-7">'
					      				+ (element[el] || "") + '</p>' + '</td>';
					      	}
					     });
						append += '</tr>';
				      	table.append(append);	
			      	});
			    }
			    else {
				    table.append('<tr><td colspan="11"> (No Results Found) </td></tr>');
			    }
			  })
		      .catch(err => {$('#productsBody tr').remove();$('#productsBody').append('<tr><td colspan="12">An Error occurred: '+err+'</td></tr>')} );
		})
	}

	async function doSearch() {
		await Promise.all([	vlistSearch(), 
							vclistSearch(),
							mrlistSearch(),
							mrclistSearch(),
							vdlistSearch(),
							vdetailsSearch(),
							productsSearch()
						]);
	}

	</script>
</head>
<body>

	<div id="navTabs" class="flexTabs">
		<ul>
			<li id="AppNavTab" class="active" onclick="$('#navTabs').find('> div, li').removeClass('active'); $(this).addClass('active'); $('#tabApp').addClass('active');">Vendor Rep Search</li>
		</ul>

		<div id="tabApp" data-tab="Vendor Rep Search">
			<div class="row">
				<div id="searchLists" class="col-8">
					<label for="searchInput" class="text-muted text-uppercase d-block">Search</label>
					<input id="searchInput" class="form-control w-100" type="text" chars="valid-only" >
					<span id="searchValidation" validation-for="searchInput" style="color: red;display: none" >Please don't enter special characters like '&' and ' as they can break the server, thank you!
					</span>
				</div>
			</div>
			
			<button id="searchInputBtn" type="button" class="btn btn-info mt-2 mb-4 w-25" style="max-width:500px" onclick="doSearch()"><span class="mbri-search mbr-iconfont mbr-iconfont-btn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" fill="currentColor"><path d="M10.875 17.534l-10.024 10.002c-1.192 1.19-1.033 2.844-0.138 3.745s2.55 1.062 3.747-0.135l9.987-9.987c0.654-0.628-0.336-1.575-0.943-0.943l-9.987 9.987c-0.772 0.772-1.425 0.575-1.859 0.138s-0.627-1.101 0.135-1.862l10.024-10.002c0.56-0.56-0.336-1.549-0.943-0.943zM20.266 2.742c-1.925 0.259-3.756 1.212-5.083 2.807-0.569 0.684 0.435 1.564 1.026 0.854 2.219-2.667 6.095-3.188 8.94-1.203 0.729 0.509 1.492-0.585 0.763-1.094-1.702-1.187-3.721-1.624-5.646-1.365zM21.333 0c-5.883 0-10.667 4.783-10.667 10.667s4.784 10.667 10.667 10.667c5.883 0 10.667-4.783 10.667-10.667s-4.784-10.667-10.667-10.667zM21.333 1.333c5.163 0 9.333 4.171 9.333 9.333s-4.171 9.333-9.333 9.333c-5.163 0-9.333-4.171-9.333-9.333s4.171-9.333 9.333-9.333z"></path></svg></span>
			&nbsp; Search</button>
<!-- VENDOR LIST -->
			<h5 id="vlistTitle" class="text-primary bde-arrow-cont mt-4" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
				<div class="arrow"></div>Vendor List
			</h5>
			<div class="container-fluid" style="display:none">
				<table id="vlistTable" class="tabModern">
					<thead>
                        <tr>

							<th class="view-tiny">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor Name</p>
                            </th><th class="view-medium">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor #</p>
                            </th><th>
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Placing P.O.'s</p>
                            </th><th class="view-tiny">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Phone #</p>
                            </th><th >
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Fax #</p>
                            </th><th class="view-tiny">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Manufacturer Rep</p>
                            </th><th >
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Website</p>
                            </th><th class="view-medium">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Parts Sold</p>
                            </th><th class="view-medium">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Keywords</p>
                            </th><th class="view-show-all">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Edit</p>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="vlistBody"></tbody>
				</table>
			</div>
<!-- VENDOR CONTACT LIST -->
			<h5 id="vclistTitle" class="text-primary bde-arrow-cont mt-4" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
				<div class="arrow"></div>Vendor Contact List
			</h5>
			<div id="" class="container-fluid" style="display:none">
				<table id="vclistTable" class="tabModern">
					<thead>
                        <tr>

                        <th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">First</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Last</p>
                        </th><th>
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Job Title</p>
                        </th><th class="view-small">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Email</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Business Phone #</p>
                        </th><th>
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Cell #</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Company</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor Name</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor #</p>
                        </th><th>
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Keywords</p>
                        </th><th class="view-show-all">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Edit</p>
                        </th>
                        </tr>
                    </thead>
                    <tbody id="vclistBody"></tbody>
				</table>
			</div>
<!-- MANUFACTURER REPS LIST -->
			<h5 id="mrlistTitle" class="text-primary bde-arrow-cont mt-4" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
				<div class="arrow"></div>Manufacturer Reps List
			</h5>
			<div id="" class="container-fluid" style="display:none">
				<table id="vclistTable" class="tabModern">
					<thead>
					<tr>
							<th class="view-tiny">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Manufacturer Rep</p>
                            </th><th class="view-tiny">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Manufacturer Rep#</p>
                            </th><th class="view-tiny">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Email</p>
                            </th><th class="view-tiny">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor Name</p>
                            </th><th class="view-small">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor #</p>
                            </th><th class="view-medium">
                                <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Keywords</p>
                            </th><th class="view-show-all">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Edit</p>
                        </th>
                    </tr>
                    </thead>
                    <tbody id="mrlistBody"></tbody>
                </table>
			</div>
<!-- MANUFACTURER REP CONTACT LIST -->
			<h5 id="mrclistTitle" class="text-primary bde-arrow-cont mt-4" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
				<div class="arrow"></div>Manufacturer Reps Contact List
			</h5>
			<div id="" class="container-fluid" style="display:none">
				<table id="mrclistTable" class="tabModern">
					<thead>
					<tr>
                        <th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">First</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Last</p>
                        </th><th>
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Job Title</p>
                        </th><th class="view-small">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Email</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Business Phone #</p>
                        </th><th>
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Cell #</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Manufacturer Rep</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor Name</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor #</p>
                        </th><th class="view-show-all">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Edit</p>
                        </th>
                    </tr>
                    </thead>
                    <tbody id="mrclistBody"></tbody>
                </table>
			</div>
<!-- VENDOR DOCUMENT LIST -->
			<h5 id="vdlistTitle" class="text-primary bde-arrow-cont mt-4" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
				<div class="arrow"></div>Vendor Documents
			</h5>
			<div id="" class="container-fluid" style="display:none">
				<table id="vdlistTable" class="tabModern">
					<thead>
					<tr>
			                                    
                    <th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Name</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Type</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor Name</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor #</p>
                        </th><th class="view-small">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Modified By</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Modified</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Keywords</p>
                        </th><th class="view-show-all">
                        	<p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Download</p>
                    	</th>
                    </tr>
                    </thead>
                    <tbody id="vdlistBody"></tbody>
                </table>
			</div>
<!-- VENDOR DETAILS LIST -->
			<h5 id="vdetailsTitle" class="text-primary bde-arrow-cont mt-4" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
				<div class="arrow"></div>Vendor Details
			</h5>
			<div id="" class="container-fluid" style="display:none">
				<table id="vdetailsTable" class="tabModern">
					 <thead>
                        <tr>
                            
                        <th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor Name</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor #</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Suggested Sales Multiplier</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Cost Info</p>
                        </th><th class="view-small">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Freight Info</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Return Info</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Comments</p>
                        </th><th>
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Keywords</p>
                        </th><th class="view-show-all">
                        	<p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Edit</p>
                    	</th>

                        </tr>
                    </thead>
                    <tbody id="vdetailsBody"></tbody>
				</table>
			</div>
<!-- PRODUCT LINE LIST -->
			<h5 id="productsTitle" class="text-primary bde-arrow-cont mt-4" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
				<div class="arrow"></div>Product Line List
			</h5>
			<div id="" class="container-fluid" style="display:none">
				<table id="productsTable" class="tabModern">
					 <thead>
                        <tr>
                            
                        <th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor Name</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Vendor #</p>
                        </th><th class="view-tiny">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Product Line</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Description</p>
                        </th><th class="view-small">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Warehouse</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Buyer</p>
                        </th><th class="view-medium">
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Buyer Initials</p>
                        </th><th>
                            <p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Keywords</p>
                        </th><th class="view-show-all">
                        	<p class="mbr-text tabletitle mbr-fonts-style mbr-white align-center display-7">Edit</p>
                    	</th>

                        </tr>
                    </thead>
                    <tbody id="productsBody"></tbody>
				</table>
			</div>
	</div>
	<script type="text/javascript">
	/*********************************************************
	- Author: Sebastian Cubillos
	- Github: @tianes
	- Comment: Don't re-invent the wheel, thanks @tianes
	**********************************************************/
		$(document).on('keyup change input', '[chars]', function(event) {

		  var $elem = $(this),
		    value = $elem.val(),
		    regReplace,
		    preset = {
		      'numbers-only': '0-9',
		      'letters': 'A-Za-z\\s',
		      'email': '\\w@._\\-',
		      'valid-only': '\\w\\s\,\.\-',
		    },
		    filter = preset[$elem.attr('chars')] || $elem.attr('chars');

		  regReplace = new RegExp('[^' + filter + ']', 'ig');

		  // KEEPS TRIGGERING ON '-' character even though it passes validation... would be nice to fix at some point.
		  //regReplace.test(value) ? "" : $('#searchValidation').show().fadeOut(5000);

		  $elem.val(value.replace(regReplace, ''));
		  
		});
	</script>
</body>
</html>